!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("element-resize-detector"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-ellipsis",["exports","@angular/core","element-resize-detector","@angular/common"],t):t((e=e||self)["ngx-ellipsis"]={},e.ng.core,e.elementResizeDetectorMaker,e.ng.common)}(this,(function(e,t,i,s){"use strict";i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;var r=function(){function e(e,i,s,r){this.elementRef=e,this.renderer=i,this.ngZone=s,this.platformId=r,this.ellipsisContent=null,this.moreClickEmitter=new t.EventEmitter,this.changeEmitter=new t.EventEmitter}return e.numericBinarySearch=function(e,t){for(var i,s=0,r=e,n=-1;s<=r;){t(i=~~((s+r)/2))?(n=i,s=i+1):r=i-1}return n},e.convertEllipsisInputToString=function(e){return null==e?"":String(e)},e.prototype.ngAfterViewInit=function(){if(s.isPlatformBrowser(this.platformId)){""===this.ellipsisCharacters&&(this.ellipsisCharacters="..."),this.moreAnchor=this.renderer.createElement("a"),this.moreAnchor.className="ngx-ellipsis-more",this.moreAnchor.href="#",this.moreAnchor.textContent=this.ellipsisCharacters,this.ellipsisWordBoundaries||(this.ellipsisWordBoundaries=""),this.ellipsisWordBoundaries="["+this.ellipsisWordBoundaries.replace(/\\n/,"\n").replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"]",this.ellipsisSubstrFn||(this.ellipsisSubstrFn=function(e,t,i){return e.substr(t,i)}),this.elem=this.elementRef.nativeElement,void 0!==this.ellipsisContent&&null!==this.ellipsisContent?this.originalText=e.convertEllipsisInputToString(this.ellipsisContent):this.originalText||(this.originalText=this.elem.textContent.trim()),this.renderer.setProperty(this.elem,"innerHTML",""),this.innerElem=this.renderer.createElement("div"),this.renderer.addClass(this.innerElem,"ngx-ellipsis-inner");var t=this.renderer.createText(this.originalText);this.renderer.appendChild(this.innerElem,t),this.renderer.appendChild(this.elem,this.innerElem),this.addResizeListener(!0)}},e.prototype.ngOnChanges=function(){this.elem&&void 0!==this.ellipsisContent&&this.originalText!==e.convertEllipsisInputToString(this.ellipsisContent)&&(this.originalText=e.convertEllipsisInputToString(this.ellipsisContent),this.applyEllipsis())},e.prototype.ngOnDestroy=function(){s.isPlatformBrowser(this.platformId)&&this.removeAllListeners()},e.prototype.removeAllListeners=function(){this.destroyMoreClickListener&&this.destroyMoreClickListener(),this.removeResizeListener()},e.prototype.addResizeListener=function(e){switch(void 0===e&&(e=!1),void 0===this.resizeDetectionStrategy&&(this.resizeDetectionStrategy=""),this.resizeDetectionStrategy){case"manual":break;case"window":this.addWindowResizeListener();break;case"element-resize-detector-object":this.addElementResizeListener(!1);break;default:"undefined"!=typeof console&&console.warn("No such ellipsis-resize-detection strategy: '"+this.resizeDetectionStrategy+"'. Using 'element-resize-detector' instead");case"element-resize-detector":case"":this.addElementResizeListener()}e&&"manual"!==this.resizeDetectionStrategy&&this.applyEllipsis()},e.prototype.addWindowResizeListener=function(){var e=this;this.removeWindowResizeListener=this.renderer.listen("window","resize",(function(){e.ngZone.run((function(){e.applyEllipsis()}))}))},e.prototype.addElementResizeListener=function(t){var s=this;void 0===t&&(t=!0),e.elementResizeDetector||(e.elementResizeDetector=i({strategy:t?"scroll":"object"}));var r=!0;e.elementResizeDetector.listenTo(this.elementRef.nativeElement,(function(){r?r=!1:s.applyEllipsis()}))},e.prototype.removeResizeListener=function(){"window"!==this.resizeDetectionStrategy?e.elementResizeDetector&&this.elem&&e.elementResizeDetector.removeAllListeners(this.elem):this.removeWindowResizeListener()},e.prototype.getTruncatedText=function(e){if(!this.originalText||this.originalText.length<=e)return this.originalText;var t=this.ellipsisSubstrFn(this.originalText,0,e);if("[]"===this.ellipsisWordBoundaries||this.originalText.charAt(e).match(this.ellipsisWordBoundaries))return t;for(var i=e-1;i>0&&!t.charAt(i).match(this.ellipsisWordBoundaries);)i--;return this.ellipsisSubstrFn(t,0,i)},e.prototype.truncateText=function(e,t){var i=this;void 0===t&&(t=!1);var s=this.getTruncatedText(e),r=s.length,n=r!==this.originalText.length;return n&&!this.showMoreLink&&(s+=this.ellipsisCharacters),this.renderer.setProperty(this.innerElem,"textContent",s),n&&this.showMoreLink&&this.renderer.appendChild(this.innerElem,this.moreAnchor),this.destroyMoreClickListener&&(this.destroyMoreClickListener(),this.destroyMoreClickListener=null),t&&n&&(this.destroyMoreClickListener=this.renderer.listen(this.moreAnchor,"click",(function(e){e.target&&"ngx-ellipsis-more"===e.target.className&&(e.preventDefault(),i.moreClickEmitter.emit(e))}))),r},e.prototype.applyEllipsis=function(){var t=this;this.removeResizeListener();var i=e.numericBinarySearch(this.originalText.length,(function(e){return t.truncateText(e),!t.isOverflowing})),s=this.truncateText(i,this.showMoreLink);this.addResizeListener(),this.changeEmitter.observers.length>0&&this.changeEmitter.emit(this.originalText.length===s?null:s)},Object.defineProperty(e.prototype,"isOverflowing",{get:function(){var e=this.elem.style.overflow;e&&"visible"!==e||(this.elem.style.overflow="hidden");var t=this.elem.clientWidth<this.elem.scrollWidth-1||this.elem.clientHeight<this.elem.scrollHeight-1;return this.elem.style.overflow=e,t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showMoreLink",{get:function(){return this.moreClickEmitter.observers.length>0},enumerable:!0,configurable:!0}),e.elementResizeDetector=null,e.decorators=[{type:t.Directive,args:[{selector:"[ellipsis]",exportAs:"ellipsis"}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:t.NgZone},{type:Object,decorators:[{type:t.Inject,args:[t.PLATFORM_ID]}]}]},e.propDecorators={ellipsisCharacters:[{type:t.Input,args:["ellipsis"]}],ellipsisContent:[{type:t.Input,args:["ellipsis-content"]}],ellipsisWordBoundaries:[{type:t.Input,args:["ellipsis-word-boundaries"]}],ellipsisSubstrFn:[{type:t.Input,args:["ellipsis-substr-fn"]}],resizeDetectionStrategy:[{type:t.Input,args:["ellipsis-resize-detection"]}],moreClickEmitter:[{type:t.Output,args:["ellipsis-click-more"]}],changeEmitter:[{type:t.Output,args:["ellipsis-change"]}]},e}();var n=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[],declarations:[r],exports:[r]}]}],e}();e.EllipsisDirective=r,e.EllipsisModule=n,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-ellipsis.umd.min.js.map